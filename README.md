# - 1 -
# NSTwitterApi

## What is this?
This is a .NET twitter api client allowing to interact with twitter as if being on the webpage by emulating the fetch-calls.

## How does it work?
It bypasses the api routine by providing the `auth_token` cookie appearing to twitter as if the user is logged in.

## Examples?

### Initialization
```csharp
using var api = new X("auth_token")
{
	CacheReader = (id) =>
{
	if (File.Exists(id + ".cache0"))
		return File.ReadAllText(id + ".cache0");
	return null;
},
	CacheWriter = (id, csrf) => File.WriteAllText(id + ".cache0", csrf)
};
```

The properties `CacheWriter` and `CacheReader` are optional but recommended, since they save and retrieve the csrf token that is generated by the api client.
The string `auth_token` can be obtained by inspecting the cookies on twitter **when logged in** - the cookie key is - obviously - called `auth_token`.

In order to start a session we call the `.StartSession()` method which will return an instance of the class `ApiResult` providing necessary information to check whether the authentication has worked.

```csharp
var apiResult = await api.StartSession();

if (apiResult.ApiStatus != ApiStatusCode.Ok)
	return;

Console.WriteLine(api);
```

When authentication has succeeded, you will see your twitter rest id along with your twitter screen name.

### Handling notification

We can hook notification by subscribing the event `.Notification` like so:

```csharp
api.Notification += Api_Notification;

async void Api_Notification(INotificationData data, NotificationHandler handler)
{
	Console.WriteLine("Responder name:  " + data.ScreenName);
	Console.WriteLine(data);
	await handler.MarkAsRead();
}
```
`.MarkAsRead()` ensures the received notifications won't be received a second time.

You can control the notification poll time by specifying a number in the constructor of `X`:

```csharp 
using var api = new X("auth0", true, 20) // poll notifications every 20 second, default is 5 seconds
```

Currently, only following, likes, mentions and replies are notified.
The corresponding classes are defined in `NSTwitterApi.Models.Notification`.

### More methods avaible', but not in the mood to finish the readme today ;D


_



